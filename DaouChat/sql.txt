-chatgroup-

create table chatgroup(
groupid varchar(80),
userid varchar(20),
groupname varchar(45),
primary key (groupid)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;


insert into chatgroup(userid,groupname) values('1','1');


-chatcontent-

CREATE TABLE chatcontent
(
    `userid`    varchar2(20)     NOT NULL    COMMENT '보낸사람', 
    `groupid`   varchar2(80)           NOT NULL    COMMENT '채팅방 아이디', 
    `content`   VARCHAR2(1000)    NULL        COMMENT '채팅내용', 
    `sendtime`  datetime      NOT NULL    COMMENT '보낸시간', 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-user-
create table user(
userid varchar(20),
password varchar(45),
primary key(userid)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-friend-
create table friend(
userid varchar(20),
friendid varchar(20)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-chatmember-
create table chatmember(
groupid varchar(80),
userid varchar(20)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

--존재하는그룹인지 확인--
select b.groupid from 
(select groupid, count(*) ccnt from chatmember where groupid in (select a.groupid from (select groupid, count(groupid) cnt from chatmember where userid in ('q','asdf') group by groupid having cnt =2) a) group by groupid) b
where b.ccnt = 2;


--채팅그룹이있으면 groupid 가져오는 쿼리문--
select b.groupid from 
	(select groupid, count(*) ccnt from chatmember where groupid in (select a.groupid from (select groupid, count(groupid) cnt from chatmember where userid in ('ㅁ','q') group by groupid having cnt =2) a) group by groupid) b 

